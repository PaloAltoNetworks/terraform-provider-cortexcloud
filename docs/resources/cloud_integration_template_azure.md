---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "cortexcloud_cloud_integration_template_azure Resource - Cortex Cloud Provider"
subcategory: ""
description: |-
  Manages a cloud onboarding integration template for Azure.
---

# cortexcloud_cloud_integration_template_azure (Resource)

Manages a cloud onboarding integration template for Azure.

## Example Usage

```terraform
# Azure management group onboarding template.
#
# This template will be created with the following configuration:
#   - Instance name of "Azure Management Group"
#   - Scans scoped to:
#     - eastus and centralus regions
#     - all subscriptions that do NOT have the following ID values:
#       - fe8dd810-6863-4795-bb65-19ed7f3f5d8a
#       - 0bb6c67d-95bb-499c-9efa-cdf91e63ccf5
#   - Targeting Azure tenant ID "0091a7ea-5021-42d3-a276-18004980b42b"
#   - All additional capabilities enabled
#       - Registry scanning configured to initially scan all discovered 
#         container images, including all versions (tags), in all discovered
#         ACR repositories
#   - Audit log (Azure Event Hubs) collection enabled 
#   - The "environment" tag with the value "production" will be applied to all 
#     resources created by Cortex Cloud in the target Azure environment
#       - An additional "managed_by" tag with the value "paloaltonetworks" is
#         applied by default for all onboarded CSP environments
resource "cortexcloud_cloud_integration_template_azure" "management-group" {
  scope         = "ACCOUNT_GROUP"
  instance_name = "Azure Management Group"
  scan_mode     = "MANAGED"
  account_details = {
    organization_id = "0091a7ea-5021-42d3-a276-18004980b42b" # Azure tenant ID
  }
  scope_modifications = {
    regions = {
      enabled = true
      type    = "INCLUDE"
      regions = [
        "eastus",
        "centralus",
      ]
    }
    subscriptions = {
      enabled = true
      type    = "EXCLUDE"
      subscription_ids = [
        "fe8dd810-6863-4795-bb65-19ed7f3f5d8a",
        "0bb6c67d-95bb-499c-9efa-cdf91e63ccf5",
      ]
    }
  }
  additional_capabilities = {
    data_security_posture_management = true
    registry_scanning                = true
    registry_scanning_options = {
      type = "ALL"
    }
    xsiam_analytics         = true
    agentless_disk_scanning = true
    serverless_scanning     = true
  }
  collection_configuration = {
    audit_logs = {
      enabled           = true
      collection_method = "AUTOMATED"
      data_events       = false
    }
  }
  custom_resources_tags = [
    {
      key   = "environment"
      value = "production"
    },
  ]
}
```

```terraform
# Azure subscription onboarding template.
#
# This template will be created with the following configuration:
#   - Instance name of "Azure Subscription"
#   - Scans scoped to the eastus and centralus regions
#   - Targeting Azure tenant ID "a1b2c3d4-e5f6-7890-1234-567890abcdef"
#   - All additional capabilities enabled
#       - Registry scanning configured to initially scan all discovered 
#         container images, including all versions (tags), in all discovered
#         ACR repositories
#   - Audit log (Azure Event Hubs) collection enabled 
#   - The "environment" tag with the value "production" will be applied to all 
#     resources created by Cortex Cloud in the target Azure environment
#       - An additional "managed_by" tag with the value "paloaltonetworks" is
#         applied by default for all onboarded CSP environments
resource "cortexcloud_cloud_integration_template_azure" "subscription" {
  scope         = "ACCOUNT"
  instance_name = "Azure Subscription"
  scan_mode     = "MANAGED"
  account_details = {
    organization_id = "a1b2c3d4-e5f6-7890-1234-567890abcdef" # Azure tenant ID
  }
  scope_modifications = {
    regions = {
      enabled = true
      type    = "INCLUDE"
      regions = [
        "eastus",
        "centralus",
      ]
    }
  }
  additional_capabilities = {
    data_security_posture_management = true
    registry_scanning                = true
    registry_scanning_options = {
      type = "ALL"
    }
    xsiam_analytics         = true
    agentless_disk_scanning = true
    serverless_scanning     = true
  }
  collection_configuration = {
    audit_logs = {
      enabled = true
    }
  }
  custom_resources_tags = [
    {
      key   = "environment"
      value = "production"
    },
  ]
}
```

```terraform
# Azure tenant onboarding template.
# TODO: change subscription id guids, test
# This template will be created with the following configuration:
#   - Instance name of "Azure Management Group"
#   - Scans scoped to:
#     - eastus and centralus regions
#     - all subscriptions that do NOT have the following ID values:
#       - fe8dd810-6863-4795-bb65-19ed7f3f5d8a
#       - 0bb6c67d-95bb-499c-9efa-cdf91e63ccf5
#   - Targeting Azure tenant ID "39b3bc2e-77f4-49c5-9298-8f8972abf448"
#   - All additional capabilities enabled
#       - Registry scanning configured to initially scan all discovered 
#         container images, including all versions (tags), in all discovered
#         ACR repositories
#   - Audit log (Azure Event Hubs) collection enabled 
#   - The "environment" tag with the value "production" will be applied to all 
#     resources created by Cortex Cloud in the target Azure environment
#       - An additional "managed_by" tag with the value "paloaltonetworks" is
#         applied by default for all onboarded CSP environments
resource "cortexcloud_cloud_integration_template_azure" "" {
  scope         = "ORGANIZATION"
  instance_name = "Azure Management Group"
  scan_mode     = "MANAGED"
  account_details = {
    organization_id = "39b3bc2e-77f4-49c5-9298-8f8972abf448" # Azure tenant ID
  }
  scope_modifications = {
    regions = {
      enabled = true
      type    = "INCLUDE"
      regions = [
        "eastus",
        "centralus",
      ]
    }
    subscriptions = {
      enabled = true
      type    = "EXCLUDE"
      subscription_ids = [
        "fe8dd810-6863-4795-bb65-19ed7f3f5d8a",
        "0bb6c67d-95bb-499c-9efa-cdf91e63ccf5",
      ]
    }
  }
  additional_capabilities = {
    data_security_posture_management = true
    registry_scanning                = true
    registry_scanning_options = {
      type = "ALL"
    }
    xsiam_analytics         = true
    agentless_disk_scanning = true
    serverless_scanning     = true
  }
  collection_configuration = {
    audit_logs = {
      enabled = true
    }
  }
  custom_resources_tags = [
    {
      key   = "environment"
      value = "production"
    },
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `account_details` (Attributes) Additional details required for account onboarding. (see [below for nested schema](#nestedatt--account_details))
- `scan_mode` (String) Define what infrastructure the integration will use to scan cloud workloads. If set to `MANAGED`, scanning will be done in the Cortex Cloud environment. If set to `OUTPOST`, scanning will be done on infrastructure deployed to a cloud account owned by you. Possible values are: `MANAGED`, `OUTPOST`. 

~>**NOTE** Scanning with an outpost may require additional CSP permissions and may incur additional costs.
- `scope` (String) Define the scope for this integration instance. Possible values are: `ACCOUNT`, `ACCOUNT_GROUP`, `ORGANIZATION`

### Optional

- `additional_capabilities` (Attributes) Define which additional security capabilities to enable. 

~>**NOTE** that adding additional capabilities typically requires additional cloud provider permissions. For more information, refer to the [Cortex Cloud Posture Management documentation](https://docs-cortex.paloaltonetworks.com/r/Cortex-CLOUD/Cortex-Cloud-Posture-Management-Documentation/Cloud-service-provider-permissions). (see [below for nested schema](#nestedatt--additional_capabilities))
- `collection_configuration` (Attributes) Configure log data collection. (see [below for nested schema](#nestedatt--collection_configuration))
- `custom_resources_tags` (Attributes Set) Tags applied to any new resource created by Cortex Cloud in the cloud environment.

The tag `managed_by` with the value `paloaltonetworks` will be applied by default. (see [below for nested schema](#nestedatt--custom_resources_tags))
- `instance_name` (String) The name of the integration template. When the template is executed, integrations will appear in the console with this value.
- `outpost_id` (String) The ID of the outpost that will be used for scanning. Must be configured if `scan_mode` is set to `OUTPOST`.
- `scope_modifications` (Attributes) Define the scope of scans by including/excluding subscriptions or regions. (see [below for nested schema](#nestedatt--scope_modifications))

### Read-Only

- `arm_template_url` (String) The full URL returned by Cortex Cloud when selecting the Azure Resource Manager method of downloading the template. Opening this URL in your browser will begin a download of the created template as an ARM template, which you can then deploy to permit Cortex Cloud to scan your Azure resources.
- `status` (String) Status of the template.
- `terraform_module_url` (String) The full URL returned by Cortex Cloud when selecting the Terraform method of downloading the template. Opening this URL in your browser will begin a download of the created template as a Terraform module, which you can then apply to permit Cortex Cloud to scan your Azure resources.
- `tracking_guid` (String) The unique ID value assigned to this template after creation.

<a id="nestedatt--account_details"></a>
### Nested Schema for `account_details`

Required:

- `organization_id` (String, Sensitive) Your Azure tenant ID.

~>**NOTE**: You must first approve Cortex Cloud as an enterprise application in your Azure tenant before attempting to create this resource. If you attempt to create a template for a tenant that has not approved the Cortex Cloud application, the API will return an error.


<a id="nestedatt--additional_capabilities"></a>
### Nested Schema for `additional_capabilities`

Optional:

- `agentless_disk_scanning` (Boolean) Whether to enable agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. Default value is `true`.

It is strongly recommended that you keep enable this feature enabled.
- `data_security_posture_management` (Boolean) Whether to enable data security posture management, an agentless data security scanner that discovers, classifies, protects, and governs sensitive data. Default value is `true`.
- `registry_scanning` (Boolean) Whether to enable registry scanning, a container registry scanner that scans registry images for vulnerabilities, malware, and secrets. Default value is `true`.
- `registry_scanning_options` (Attributes) Additional configuration options forregistry scanning. (see [below for nested schema](#nestedatt--additional_capabilities--registry_scanning_options))
- `serverless_scanning` (Boolean) Whether to enable agentless disk scanning to remotely detect and remediate vulnerabilities during the development lifecycle. Default value is `true`.
- `xsiam_analytics` (Boolean) Whether to enable XSIAM analytics to analyze your endpoint data to develop a baseline and raise Analytics and Analytics BIOC alerts when anomalies and malicious behaviors are detected. Default value is `true`.

<a id="nestedatt--additional_capabilities--registry_scanning_options"></a>
### Nested Schema for `additional_capabilities.registry_scanning_options`

Required:

- `type` (String) Type of registry scanning.

Optional:

- `last_days` (Number) Number of days within which the tags on a registry image must have been created or updated for the image to be scanned. Minimum value is 0 and maximum value is 90. Cannot be configured if `type` is not set to `TAGS_MODIFIED_DAYS`.



<a id="nestedatt--collection_configuration"></a>
### Nested Schema for `collection_configuration`

Required:

- `audit_logs` (Attributes) Configuration for audit logs collection. (see [below for nested schema](#nestedatt--collection_configuration--audit_logs))

<a id="nestedatt--collection_configuration--audit_logs"></a>
### Nested Schema for `collection_configuration.audit_logs`

Optional:

- `collection_method` (String) Method of audit log collection. Default value is `AUTOMATED`.
- `data_events` (Boolean) Whether to collect data events as part of audit log collection. Default value is `false`.
- `enabled` (Boolean) Whether to enable audit log collection. Default value is `true`.



<a id="nestedatt--custom_resources_tags"></a>
### Nested Schema for `custom_resources_tags`

Required:

- `key` (String) The tag key.
- `value` (String) The tag value.


<a id="nestedatt--scope_modifications"></a>
### Nested Schema for `scope_modifications`

Optional:

- `regions` (Attributes) (see [below for nested schema](#nestedatt--scope_modifications--regions))
- `subscriptions` (Attributes) Configuration for subscription-level scope modifications for Azure integrations. (see [below for nested schema](#nestedatt--scope_modifications--subscriptions))

<a id="nestedatt--scope_modifications--regions"></a>
### Nested Schema for `scope_modifications.regions`

Required:

- `enabled` (Boolean) Whether to enable this scope modification. If set to `true`, the `type` and `regions` attributes must be configured as well.

Optional:

- `regions` (Set of String) Regions to include or exclude from scans. Must be configured with at least 1 value if `enabled` is set to `true`.
- `type` (String) Whether the specified regions should be included in the scope or excluded from the scope. Must be configured if `enabled` is set to `true`. Possible values are: `INCLUDE`, `EXCLUDE`


<a id="nestedatt--scope_modifications--subscriptions"></a>
### Nested Schema for `scope_modifications.subscriptions`

Required:

- `enabled` (Boolean) Whether to enable this scope modification. Cannot be set to `true` if scope is set to `ACCOUNT`. If enabled, the `type` and `subscription_ids` attributes must be configured as well.

Optional:

- `subscription_ids` (Set of String) Subscription IDs to include or exclude from scans. Cannot be configured if scope is set to `ACCOUNT`. If scope is set to `ORGANIZATION` or `ACCOUNT_GROUP` and enabled is set to `true`, it must be configured with at least 1 value.
- `type` (String) Whether the specified subscription IDs should be included in the scope or excluded from the scope. Must be configured if `enabled` is set to `true` and scope is not set to `ACCOUNT`. Possible values are: `INCLUDE`, `EXCLUDE`
